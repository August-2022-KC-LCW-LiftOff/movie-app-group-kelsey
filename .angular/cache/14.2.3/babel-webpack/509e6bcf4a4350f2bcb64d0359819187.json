{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { ActiveCommentTypeEnum } from '../activeComment/activeCommentType.enum';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"../commentForm/commentForm.component\";\n\nfunction CommentComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.comment.body);\n  }\n}\n\nfunction CommentComponent_comment_form_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"comment-form\", 13);\n    i0.ɵɵlistener(\"handleSubmit\", function CommentComponent_comment_form_10_Template_comment_form_handleSubmit_0_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.updateComment.emit({\n        text: $event,\n        commentId: ctx_r7.comment.id\n      }));\n    })(\"handleCancel\", function CommentComponent_comment_form_10_Template_comment_form_handleCancel_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.setActiveComment.emit(null));\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"hasCancelButton\", true)(\"initialText\", ctx_r1.comment.body);\n  }\n}\n\nfunction CommentComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵlistener(\"click\", function CommentComponent_div_12_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.setActiveComment.emit({\n        id: ctx_r10.comment.id,\n        type: ctx_r10.activeCommentType.replying\n      }));\n    });\n    i0.ɵɵtext(1, \" Reply \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CommentComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵlistener(\"click\", function CommentComponent_div_13_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.setActiveComment.emit({\n        id: ctx_r12.comment.id,\n        type: ctx_r12.activeCommentType.editing\n      }));\n    });\n    i0.ɵɵtext(1, \" Edit \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CommentComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵlistener(\"click\", function CommentComponent_div_14_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.deleteComment.emit(ctx_r14.comment.id));\n    });\n    i0.ɵɵtext(1, \" Delete \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CommentComponent_comment_form_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"comment-form\", 15);\n    i0.ɵɵlistener(\"handleSubmit\", function CommentComponent_comment_form_15_Template_comment_form_handleSubmit_0_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.addComment.emit({\n        text: $event,\n        parentId: ctx_r16.replyId\n      }));\n    });\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c0 = function () {\n  return [];\n};\n\nfunction CommentComponent_div_16_comment_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"comment\", 18);\n    i0.ɵɵlistener(\"setActiveComment\", function CommentComponent_div_16_comment_1_Template_comment_setActiveComment_0_listener($event) {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r20 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r20.setActiveComment.emit($event));\n    })(\"updateComment\", function CommentComponent_div_16_comment_1_Template_comment_updateComment_0_listener($event) {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r22 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r22.updateComment.emit($event));\n    })(\"deleteComment\", function CommentComponent_div_16_comment_1_Template_comment_deleteComment_0_listener($event) {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r23 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r23.deleteComment.emit($event));\n    })(\"addComment\", function CommentComponent_div_16_comment_1_Template_comment_addComment_0_listener($event) {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r24 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r24.addComment.emit($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const reply_r19 = ctx.$implicit;\n    const ctx_r18 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"comment\", reply_r19)(\"activeComment\", ctx_r18.activeComment)(\"parentId\", ctx_r18.comment.id)(\"replies\", i0.ɵɵpureFunction0(5, _c0))(\"currentUserId\", ctx_r18.currentUserId);\n  }\n}\n\nfunction CommentComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵtemplate(1, CommentComponent_div_16_comment_1_Template, 1, 6, \"comment\", 17);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r6.replies);\n  }\n}\n\nexport let CommentComponent = /*#__PURE__*/(() => {\n  class CommentComponent {\n    constructor() {\n      this.setActiveComment = new EventEmitter();\n      this.deleteComment = new EventEmitter();\n      this.addComment = new EventEmitter();\n      this.updateComment = new EventEmitter();\n      this.createdAt = '';\n      this.canReply = false;\n      this.canEdit = false;\n      this.canDelete = false;\n      this.activeCommentType = ActiveCommentTypeEnum;\n      this.replyId = null;\n    }\n\n    ngOnInit() {\n      const fiveMinutes = 300000;\n      const timePassed = new Date().getMilliseconds() - new Date(this.comment.createdAt).getMilliseconds() > fiveMinutes;\n      this.createdAt = new Date(this.comment.createdAt).toLocaleDateString();\n      this.canReply = Boolean(this.currentUserId);\n      this.canEdit = this.currentUserId === this.comment.userId && !timePassed;\n      this.canDelete = this.currentUserId === this.comment.userId && this.replies.length === 0 && !timePassed;\n      this.replyId = this.parentId ? this.parentId : this.comment.id;\n    }\n\n    isReplying() {\n      if (!this.activeComment) {\n        return false;\n      }\n\n      return this.activeComment.id === this.comment.id && this.activeComment.type === this.activeCommentType.replying;\n    }\n\n    isEditing() {\n      if (!this.activeComment) {\n        return false;\n      }\n\n      return this.activeComment.id === this.comment.id && this.activeComment.type === 'editing';\n    }\n\n  }\n\n  CommentComponent.ɵfac = function CommentComponent_Factory(t) {\n    return new (t || CommentComponent)();\n  };\n\n  CommentComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CommentComponent,\n    selectors: [[\"comment\"]],\n    inputs: {\n      comment: \"comment\",\n      activeComment: \"activeComment\",\n      replies: \"replies\",\n      currentUserId: \"currentUserId\",\n      parentId: \"parentId\"\n    },\n    outputs: {\n      setActiveComment: \"setActiveComment\",\n      deleteComment: \"deleteComment\",\n      addComment: \"addComment\",\n      updateComment: \"updateComment\"\n    },\n    decls: 17,\n    vars: 9,\n    consts: [[1, \"comment\"], [1, \"comment-image-container\"], [\"src\", \"/assets/user-icon.png\"], [1, \"comment-right-part\"], [1, \"comment-content\"], [1, \"comment-author\"], [\"class\", \"comment-text\", 4, \"ngIf\"], [\"submitLabel\", \"Update\", 3, \"hasCancelButton\", \"initialText\", \"handleSubmit\", \"handleCancel\", 4, \"ngIf\"], [1, \"comment-actions\"], [\"class\", \"comment-action\", 3, \"click\", 4, \"ngIf\"], [\"submitLabel\", \"Reply\", 3, \"handleSubmit\", 4, \"ngIf\"], [\"class\", \"replies\", 4, \"ngIf\"], [1, \"comment-text\"], [\"submitLabel\", \"Update\", 3, \"hasCancelButton\", \"initialText\", \"handleSubmit\", \"handleCancel\"], [1, \"comment-action\", 3, \"click\"], [\"submitLabel\", \"Reply\", 3, \"handleSubmit\"], [1, \"replies\"], [3, \"comment\", \"activeComment\", \"parentId\", \"replies\", \"currentUserId\", \"setActiveComment\", \"updateComment\", \"deleteComment\", \"addComment\", 4, \"ngFor\", \"ngForOf\"], [3, \"comment\", \"activeComment\", \"parentId\", \"replies\", \"currentUserId\", \"setActiveComment\", \"updateComment\", \"deleteComment\", \"addComment\"]],\n    template: function CommentComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵelement(2, \"img\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 3)(4, \"div\", 4)(5, \"div\", 5);\n        i0.ɵɵtext(6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"div\");\n        i0.ɵɵtext(8);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(9, CommentComponent_div_9_Template, 2, 1, \"div\", 6);\n        i0.ɵɵtemplate(10, CommentComponent_comment_form_10_Template, 1, 2, \"comment-form\", 7);\n        i0.ɵɵelementStart(11, \"div\", 8);\n        i0.ɵɵtemplate(12, CommentComponent_div_12_Template, 2, 0, \"div\", 9);\n        i0.ɵɵtemplate(13, CommentComponent_div_13_Template, 2, 0, \"div\", 9);\n        i0.ɵɵtemplate(14, CommentComponent_div_14_Template, 2, 0, \"div\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(15, CommentComponent_comment_form_15_Template, 1, 0, \"comment-form\", 10);\n        i0.ɵɵtemplate(16, CommentComponent_div_16_Template, 2, 1, \"div\", 11);\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate(ctx.comment.username);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.createdAt);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isEditing());\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isEditing());\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.canReply);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.canEdit);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.canDelete);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isReplying());\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.replies.length > 0);\n      }\n    },\n    dependencies: [i1.NgForOf, i1.NgIf, CommentComponent, i2.CommentFormComponent],\n    encapsulation: 2\n  });\n  return CommentComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}